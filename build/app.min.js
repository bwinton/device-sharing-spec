/*! loop-react 06-05-2014 */
var ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,STRINGS={viewAccount:"View Account",signIn:"Sign In",signOut:"Sign Out",changeUsername:"Change",loggedInUsername:"ally@gmail.com",loggedOutUsername:"Guest",newCallButton:"New Call",callingAs:"Calling as",searchPlaceholder:"Search...",getLinkText:"Get Link",callNamePlaceholder:"Who are you calling?",inviteExpireIn:"Invitation will expire in",sampleCallURL:"http://lo.op/nx3nd7h",shareThisLinkWith:"Share this link with",callHistory:"Call History",clearHistory:"Clear"},getRandomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},_users=[{name:"Ally Avocado",email:"ally@mail.com"},{name:"Bob Banana",email:"bob@gmail.com"},{name:"Caitlin Cantaloupe",email:"caitlin.cant@hotmail.com"},{name:"Dave Dragonfruit",email:"dd@dragons.net"},{name:"Ellie Eggplant",email:"ellie@yahoo.com"}],_animationDefaults={duration:200,easing:"easeInSine",queue:!1},BaseState=React.createClass({displayName:"BaseState",getDefaultProps:function(){return{name:"Base State",children:[],index:1}},render:function(){return React.DOM.div({className:"StateWrapper"},React.DOM.h3({className:"higher"},React.DOM.span({className:"counter"},this.props.index+1)," ",this.props.name),React.DOM.div({className:"Toolbar"},React.DOM.i({className:"fa fa-comment-o"})),React.DOM.div({className:"PanelWrapper"},this.props.children))}}),TabBar=React.createClass({displayName:"TabBar",render:function(){return React.DOM.ul({className:"TabBar"},React.DOM.li({className:0===this.props.selected?"active tip":"tip","data-tip":"Call Tab"},React.DOM.i({className:"fa fa-phone"})),React.DOM.li({className:1===this.props.selected?"active tip":"tip","data-tip":"Call History Tab"},React.DOM.i({className:"fa fa-clock-o"})),React.DOM.li({className:2===this.props.selected?"active tip":"tip","data-tip":"Invitation Revocation/Permissions Tab"},React.DOM.i({className:"fa fa-link"})))}}),PanelGroup=React.createClass({displayName:"PanelGroup",getInitialState:function(){return{isMoved:!1}},slideTo:function(a){$(this.refs.slider.getDOMNode()).velocity({translateX:a},_animationDefaults)},toggle:function(){this.slideTo(this.state.isMoved?0:"-48%"),this.setState({isMoved:!this.state.isMoved})},componentDidMount:function(){var a=this;$(this.getDOMNode()).on("PanelGroup",function(b,c){switch(c.type){case"toggle":a.toggle();break;case"back":a.slideTo(0),a.setState({isMoved:!1})}})},componentWillUnmount:function(){$(this.getDOMNode()).off("PanelGroup::toggle")},render:function(){var a=this.state.isMoved?"moved":null,b=["PanelGroup",a].join(" ");return React.DOM.div({className:b},React.DOM.div({ref:"slider",className:"PanelGroupInner"},this.props.children))}}),Profile=React.createClass({displayName:"Profile",onClick:function(){this.props.onClick(this.props.key)},render:function(){return React.DOM.div({onClick:this.onClick,className:["Profile",this.props.selected].join(" ")},React.DOM.div({className:"avatar"}),React.DOM.div({className:"details"},React.DOM.div({className:"username"},this.props.user.name),React.DOM.div({className:"email"},this.props.user.email)),React.DOM.div({className:"icons"},React.DOM.i({className:" fa fa-video-camera"}),React.DOM.i({className:" fa fa-caret-down"})))}}),SmallProfile=React.createClass({displayName:"SmallProfile",onClick:function(){this.props.onClick(this.props.key)},render:function(){return React.DOM.div({onClick:this.onClick,className:["SmallProfile","Profile",this.props.selected].join(" ")},React.DOM.div({className:"avatar"}),React.DOM.div({className:"details"},React.DOM.div({className:"username"},this.props.user.name),React.DOM.div({className:"email"},this.props.user.email)))}}),NewCallView=React.createClass({displayName:"NewCallView",mixins:[React.addons.LinkedStateMixin],getTimeFromRange:function(a){var b=1,c=100,d=Math.log(60),e=Math.log(44640),f=(e-d)/(c-b),g=Math.exp(d+f*(a-b)),h=moment.duration(g,"minutes");if(h.asMinutes()>1440){var i=parseInt(h.asDays(),10),j=i>1?"s":"";return i+" day"+j}var i=parseInt(h.asHours(),10)+1,j=i>1?"s":"";return i+" hour"+j},getInitialState:function(){return{callDuration:15,hasLink:!1,callName:""}},onClick:function(){return""==this.state.callName?void $(this.refs.callerNameInput.getDOMNode()).addClass("error").focus():void this.setState({hasLink:!0})},componentDidUpdate:function(){""==this.state.callName||this.state.hasLink||$(this.refs.callerNameInput.getDOMNode()).removeClass("error")},goBack:function(){$(this.getDOMNode()).trigger("PanelGroup",{type:"back"}),this.cancelCall()},cancelCall:function(){this.setState({hasLink:!1,callName:"",callDuration:15})},render:function(){return this.state.hasLink?React.DOM.div({className:"NewCallView"},BackButton({onClick:this.goBack}),React.DOM.h3(null,STRINGS.shareThisLinkWith," ",this.state.callName),React.DOM.input({value:STRINGS.sampleCallURL}),React.DOM.h5(null,React.DOM.i({className:"fa fa-clock-o"})," Expires in ",this.getTimeFromRange(this.state.callDuration)),React.DOM.div({className:"ButtonGroup"},Button({text:"Copy",style:"default"}),Button({text:"Share",style:"default"}),Button({onClick:this.cancelCall,text:"Cancel",style:"cancel"}))):React.DOM.div({className:"NewCallView"},BackButton({onClick:this.goBack}),React.DOM.h3(null,"New Invitation"),React.DOM.input({ref:"callerNameInput",valueLink:this.linkState("callName"),placeholder:STRINGS.callNamePlaceholder}),React.DOM.h5(null,React.DOM.i({className:"fa fa-clock-o"})," ",STRINGS.inviteExpireIn," ",this.getTimeFromRange(this.state.callDuration),"."),React.DOM.input({valueLink:this.linkState("callDuration"),type:"range",name:"time",min:"1",max:"100"}),Button({onClick:this.onClick,style:"action",text:STRINGS.getLinkText}))}}),BackButton=React.createClass({displayName:"BackButton",render:function(){return React.DOM.div({onClick:this.props.onClick,className:"BackButton"},React.DOM.i({className:"fa fa-chevron-left"}))}}),BuddyList=React.createClass({displayName:"BuddyList",getInitialState:function(){return{filterText:"",selectedIndex:-1}},handleChange:function(){this.setState({filterText:this.refs.filterSearchBar.refs.searchInput.getDOMNode().value,selectedIndex:0})},render:function(){var a=function(a){this.setState({selectedIndex:a})}.bind(this),b=function(b,c){var d=this.state.selectedIndex===c?"selected":null;return Profile({onClick:a,key:c,user:b,selected:d})}.bind(this),c=this.props.items;if(""!==this.state.filterText){var d=this.state.filterText.toUpperCase();c=_.filter(this.props.items,function(a){return-1!==a.name.toUpperCase().indexOf(d)})}return React.DOM.div({className:"List"},SearchBar({ref:"filterSearchBar",val:this.state.filterText,handleChange:this.handleChange}),React.DOM.ul({className:"scrollable"},ReactCSSTransitionGroup({transitionName:"button-animation"},c.map(b))))}}),SearchBar=React.createClass({displayName:"SearchBar",render:function(){return React.DOM.div({className:"SearchBarWrapper"},React.DOM.input({ref:"searchInput",className:"SearchBar",value:this.props.val,onChange:this.props.handleChange,placeholder:STRINGS.searchPlaceholder}),React.DOM.i({className:"fa fa-book tip","data-tip":"Add, Import Contacts"}))}}),Button=React.createClass({displayName:"Button",render:function(){return React.DOM.div({onClick:this.props.onClick,className:"Button "+this.props.style},this.props.text)}}),Panel=React.createClass({displayName:"Panel",render:function(){return React.DOM.div({className:"Panel"},this.props.children)}}),Header=React.createClass({displayName:"Header",getDefaultProps:function(){return{username:STRINGS.loggedOutUsername,callingAsText:STRINGS.callingAs,editText:STRINGS.changeUsername,linkText:STRINGS.signIn}},onClick:function(){$(this.getDOMNode()).trigger("PanelGroup",{type:"toggle"})},render:function(){return React.DOM.div({className:"Header"},React.DOM.h6(null,this.props.callingAsText," ",React.DOM.span({className:"bold"},this.props.username),".",React.DOM.span({className:"right"},React.DOM.a(null,this.props.editText))),Button({text:STRINGS.newCallButton,style:"action",onClick:this.onClick}))}}),Footer=React.createClass({displayName:"Footer",render:function(){return React.DOM.div({className:"Footer tip","data-tip":"Sign in to Firefox Account (or other)"},this.props.linkText)}}),HistoryList=React.createClass({displayName:"HistoryList",render:function(){return React.DOM.div({className:"HistoryList"},React.DOM.div({className:"Header"},React.DOM.div(null,STRINGS.callHistory),React.DOM.div({className:"Button"},STRINGS.clearHistory)),React.DOM.ul({className:"CallHistory"},_.range(10).map(function(a){var b,c,d=getRandomInt(0,_users.length-1),e=1===getRandomInt(0,1)?"incoming":"outgoing",f=1===getRandomInt(0,5)?"missed":"accepted";return b=React.DOM.i("missed"===f?{className:"fa fa-times-circle"}:{className:"fa fa-phone"}),c=React.DOM.i("incoming"===e?{className:"fa fa-arrow-right"}:{className:"fa fa-arrow-left"}),React.DOM.li({key:"CallerHistory"+a,className:[e,f].join(" ")},c,SmallProfile({user:_users[d]}),React.DOM.div({className:"CallDetails right"},"4:32pm May 3"))})))}}),PrecallNotSignedIn=React.createClass({displayName:"PrecallNotSignedIn",render:function(){return BaseState({name:this.props.name,index:this.props.index},TabBar({selected:this.props.tab}),PanelGroup(null,Panel({items:this.props.items},Header({username:STRINGS.loggedOutUsername,editText:STRINGS.changeUsername,slideTo:this.props.slideTo}),Footer({linkText:STRINGS.signIn})),Panel({items:this.props.items},NewCallView(null))))}}),PrecallSignedIn=React.createClass({displayName:"PrecallSignedIn",render:function(){return BaseState({name:this.props.name,index:this.props.index},TabBar({selected:this.props.tab}),PanelGroup(null,Panel({items:this.props.items},Header({username:STRINGS.loggedInUsername,editText:STRINGS.viewAccount}),BuddyList({items:this.props.items}),Footer({linkText:STRINGS.signOut})),Panel({items:this.props.items},NewCallView(null))))}}),CallHistory=React.createClass({displayName:"CallHistory",render:function(){return BaseState({name:this.props.name,index:this.props.index},TabBar({selected:this.props.tab}),Panel({items:this.props.items},HistoryList(null)))}}),states=[{name:"Precall - Not Signed In",view:PrecallNotSignedIn,tab:0},{name:"Precall - Signed In",view:PrecallSignedIn,tab:0},{name:"Call History",view:CallHistory,tab:1}];setTimeout(function(){_.each(states,function(a,b){var c=$("<div/>",{"class":"component-wrapper"})[0];$("#wrapper").append(c);var d=a.view;React.renderComponent(d({items:_users,index:b,tab:a.tab,name:a.name}),c),$(".tip").tipr({mode:"top",speed:200})})},100);