/*! loop-react 08-05-2014 */
var ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,STRINGS={viewAccount:"View Account",signIn:"Sign In",signOut:"Sign Out",changeUsername:"Change",loggedInUsername:"ally@gmail.com",loggedOutUsername:"Guest",newCallButton:"New Invitation",callingAs:"Calling as",searchPlaceholder:"Search...",getLinkText:"Get Link",callNamePlaceholder:"Who are you calling?",inviteExpireIn:"Invitation will expire in",sampleCallURL:"http://lo.op/nx3nd7h",shareThisLinkWith:"Share this link with",callHistory:"Call History",clearHistory:"Clear",invitationList:"Your Invitations",expired:"Expired",endCall:"Hang Up"},linkGenerationTime=1e3,getTimeFromRange=function(a){var b=1,c=100,d=Math.log(60),e=Math.log(44640),f=(e-d)/(c-b),g=Math.exp(d+f*(a-b)),h=moment.duration(g,"minutes");if(h.asMinutes()>1440){var i=parseInt(h.asDays(),10),j=i>1?"s":"";return i+" day"+j}var i=parseInt(h.asHours(),10)+1,j=i>1?"s":"";return i+" hour"+j},_users=[{name:"Ally Avocado",email:"ally@mail.com",index:0},{name:"Bob Banana",email:"bob@gmail.com",index:1},{name:"Caitlin Cantaloupe",email:"caitlin.cant@hotmail.com",index:2},{name:"Dave Dragonfruit",email:"dd@dragons.net",index:3},{name:"Ellie Eggplant",email:"ellie@yahoo.com",index:4}],_animationDefaults={duration:200,easing:"easeInSine",queue:!1},BaseState=React.createClass({displayName:"BaseState",getDefaultProps:function(){return{name:"Base State",children:[],index:1}},render:function(){return React.DOM.div({className:"StateWrapper"},React.DOM.h3({className:"higher"},React.DOM.span({className:"counter"},this.props.index+1)," ",this.props.name),React.DOM.div({className:"Toolbar"},React.DOM.i({className:"fa fa-comment-o"})),React.DOM.div({className:"PanelWrapper"},this.props.children))}}),BaseStateCorner=React.createClass({displayName:"BaseStateCorner",getDefaultProps:function(){return{name:"Base State",children:[],index:1}},render:function(){return React.DOM.div({className:"StateWrapper"},React.DOM.h3(null,React.DOM.span({className:"counter"},this.props.index+1)," ",this.props.name),React.DOM.div({className:"Browser"},React.DOM.div({className:"WindowWrapper"},this.props.children)))}}),TabBar=React.createClass({displayName:"TabBar",render:function(){return React.DOM.ul({className:"TabBar"},React.DOM.li({className:0===this.props.selected?"active tip":"tip","data-tip":"Call Tab"},React.DOM.a({href:"#precall"},React.DOM.i({className:"fa fa-phone"}))),React.DOM.li({className:1===this.props.selected?"active tip":"tip","data-tip":"Call History Tab"},React.DOM.a({href:"#callhistory"},React.DOM.i({className:"fa fa-clock-o"}))),React.DOM.li({className:2===this.props.selected?"active tip":"tip","data-tip":"Invitation Revocation/Permissions Tab"},React.DOM.a({href:"#invitationlist"},React.DOM.i({className:"fa fa-link"}))))}}),PanelGroup=React.createClass({displayName:"PanelGroup",getInitialState:function(){return{isMoved:!1}},slideTo:function(a){$(this.refs.slider.getDOMNode()).velocity({translateX:a},_animationDefaults)},toggle:function(){this.slideTo(this.state.isMoved?0:"-48%"),this.setState({isMoved:!this.state.isMoved})},componentDidMount:function(){var a=this;$(this.getDOMNode()).on("PanelGroup",function(b,c){switch(c.type){case"toggle":a.toggle();break;case"back":a.slideTo(0),a.setState({isMoved:!1})}})},componentWillUnmount:function(){$(this.getDOMNode()).off("PanelGroup::toggle")},render:function(){var a=this.state.isMoved?"moved":null,b=["PanelGroup",a].join(" ");return React.DOM.div({className:b},React.DOM.div({ref:"slider",className:"PanelGroupInner"},this.props.children))}}),Profile=React.createClass({displayName:"Profile",getInitialState:function(){return{isDropdownVisible:!1}},onClick:function(){this.props.onClick(this.props.key)},hideDropdown:function(){$(this.refs.callDropdown.getDOMNode()).hide(),this.setState({isDropdownVisible:!1})},toggleDropdown:function(){this.state.isDropdownVisible?$(this.refs.callDropdown.getDOMNode()).hide():$(this.refs.callDropdown.getDOMNode()).show(),this.setState({isDropdownVisible:!this.state.isDropdownVisible})},render:function(){return React.DOM.div({onClick:this.onClick,className:["Profile",this.props.selected].join(" ")},React.DOM.div({className:"avatar user-"+this.props.user.index}),React.DOM.div({className:"details"},React.DOM.div({className:"username"},this.props.user.name),React.DOM.div({className:"email"},this.props.user.email)),React.DOM.div({className:"icons",onClick:this.toggleDropdown},React.DOM.i({className:"fa fa-video-camera"}),React.DOM.i({className:"fa fa-caret-down"})),React.DOM.ul({ref:"callDropdown",onMouseLeave:this.hideDropdown,className:"Dropdown"},React.DOM.li(null,React.DOM.i({className:"fa fa-video-camera"}),"Video Call"),React.DOM.li(null,React.DOM.i({className:"fa fa-phone"}),"Audio Call"),React.DOM.li(null,React.DOM.i({className:"fa fa-user"}),"Edit Contact..."),React.DOM.li(null,React.DOM.i({className:"fa fa-trash-o"}),"Remove Contact")))}}),SmallProfile=React.createClass({displayName:"SmallProfile",onClick:function(){this.props.onClick(this.props.key)},render:function(){return React.DOM.div({onClick:this.onClick,className:["SmallProfile","Profile",this.props.selected].join(" ")},React.DOM.div({className:"avatar user-"+this.props.user.index}),React.DOM.div({className:"details"},React.DOM.div({className:"username"},this.props.user.name),React.DOM.div({className:"email"},this.props.user.email)))}}),SpinnerView=React.createClass({displayName:"SpinnerView",componentDidMount:function(){{var a=this.getDOMNode();new Spinner({color:"#999",width:4,lines:13,corners:1,trail:60}).spin(a)}},render:function(){return React.DOM.div({className:"SpinnerView"})}}),NewCallView=React.createClass({displayName:"NewCallView",mixins:[React.addons.LinkedStateMixin],getInitialState:function(){return{callDuration:15,hasLink:!1,gettingLink:!1,callName:""}},onClick:function(){if(""==this.state.callName)return void $(this.refs.callerNameInput.getDOMNode()).addClass("error").focus();var a=this;a.setState({gettingLink:!0}),this.timer=setTimeout(function(){a.setState({hasLink:!0,gettingLink:!1})},linkGenerationTime)},componentDidUpdate:function(){""==this.state.callName||this.state.hasLink||this.state.gettingLink||$(this.refs.callerNameInput.getDOMNode()).removeClass("error")},goBack:function(){$(this.getDOMNode()).trigger("PanelGroup",{type:"back"}),this.cancelCall()},cancelCall:function(){clearTimeout(this.timer),this.setState({hasLink:!1,gettingLink:!1,callName:"",callDuration:15})},render:function(){return this.state.hasLink?React.DOM.div({className:"NewCallView"},BackButton({onClick:this.goBack}),React.DOM.h3(null,STRINGS.shareThisLinkWith," ",this.state.callName),React.DOM.input({value:STRINGS.sampleCallURL}),React.DOM.h5(null,React.DOM.i({className:"fa fa-clock-o"})," Expires in ",getTimeFromRange(this.state.callDuration)),React.DOM.div({className:"ButtonGroup"},Button({text:"Copy",style:"default"}),Button({text:"Share",style:"default"}),Button({onClick:this.cancelCall,text:"Cancel",style:"cancel"}))):this.state.gettingLink?React.DOM.div({className:"NewCallView"},BackButton({onClick:this.goBack}),React.DOM.h3({className:"center"},"Generating Invitation for ",this.state.callName),SpinnerView(null),Button({onClick:this.cancelCall,text:"Cancel",style:"cancel"})):React.DOM.div({className:"NewCallView"},BackButton({onClick:this.goBack}),React.DOM.h3(null,"New Invitation"),React.DOM.input({ref:"callerNameInput",valueLink:this.linkState("callName"),placeholder:STRINGS.callNamePlaceholder}),React.DOM.h5(null,React.DOM.i({className:"fa fa-clock-o"})," ",STRINGS.inviteExpireIn," ",getTimeFromRange(this.state.callDuration),"."),React.DOM.input({valueLink:this.linkState("callDuration"),type:"range",name:"time",min:"1",max:"100"}),Button({onClick:this.onClick,style:"action",text:STRINGS.getLinkText}))}}),BackButton=React.createClass({displayName:"BackButton",render:function(){return React.DOM.div({onClick:this.props.onClick,className:"BackButton"},React.DOM.i({className:"fa fa-chevron-left"}))}}),BuddyList=React.createClass({displayName:"BuddyList",getInitialState:function(){return{filterText:"",selectedIndex:-1}},handleChange:function(){this.setState({filterText:this.refs.filterSearchBar.refs.searchInput.getDOMNode().value,selectedIndex:0})},render:function(){var a=function(a){this.setState({selectedIndex:a})}.bind(this),b=function(b,c){var d=this.state.selectedIndex===c?"selected":null;return Profile({onClick:a,key:c,user:b,selected:d})}.bind(this),c=this.props.items;if(""!==this.state.filterText){var d=this.state.filterText.toUpperCase();c=_.filter(this.props.items,function(a){return-1!==a.name.toUpperCase().indexOf(d)})}return React.DOM.div({className:"List"},SearchBar({ref:"filterSearchBar",val:this.state.filterText,handleChange:this.handleChange}),React.DOM.ul({className:"scrollable"},ReactCSSTransitionGroup({transitionName:"button-animation"},c.map(b))))}}),SearchBar=React.createClass({displayName:"SearchBar",render:function(){return React.DOM.div({className:"SearchBarWrapper"},React.DOM.input({ref:"searchInput",className:"SearchBar",value:this.props.val,onChange:this.props.handleChange,placeholder:STRINGS.searchPlaceholder}),React.DOM.i({className:"fa fa-book tip","data-tip":"Add, Import Contacts"}))}}),Button=React.createClass({displayName:"Button",render:function(){return React.DOM.div({onClick:this.props.onClick,className:"Button "+this.props.style},this.props.text)}}),Panel=React.createClass({displayName:"Panel",render:function(){return React.DOM.div({className:"Panel"},this.props.children)}}),Window=React.createClass({displayName:"Window",render:function(){return React.DOM.div({className:"Window"},WindowTitlebar({title:this.props.title,type:this.props.type}),React.DOM.div({className:"WindowBody"},this.props.children))}}),WindowTitlebar=React.createClass({displayName:"WindowTitlebar",render:function(){return React.DOM.div({className:"WindowTitlebar "+this.props.type},React.DOM.h5(null,this.props.title),React.DOM.div({className:"WindowControls"}))}}),CallControls=React.createClass({displayName:"CallControls",render:function(){return React.DOM.div({className:"CallControls"},React.DOM.i({className:"button end"},STRINGS.endCall),React.DOM.i({className:"button active fa fa-video-camera"}),React.DOM.i({className:"button fa fa-volume-up"}),React.DOM.span({className:"right"},"2:45"))}}),VideoCall=React.createClass({displayName:"VideoCall",render:function(){return React.DOM.div({className:"VideoCall"},CallControls(null),React.DOM.div({className:"VideoScreen"},React.DOM.div({className:"VideoScreenInner"})))}}),IncomingCall=React.createClass({displayName:"IncomingCall",render:function(){return React.DOM.div({className:"IncomingCall"},React.DOM.div({className:"avatar"}),React.DOM.h3(null,"Aubrey Drake Graham"),React.DOM.div({className:"ButtonGroup"},Button({text:"Ignore",style:"cancel"}),Button({text:"Answer",style:"action"})))}}),Header=React.createClass({displayName:"Header",getDefaultProps:function(){return{username:STRINGS.loggedOutUsername,callingAsText:STRINGS.callingAs,editText:STRINGS.changeUsername,linkText:STRINGS.signIn}},onClick:function(){$(this.getDOMNode()).trigger("PanelGroup",{type:"toggle"})},render:function(){return React.DOM.div({className:"Header"},React.DOM.h6(null,this.props.callingAsText," ",React.DOM.span({className:"bold"},this.props.username),".",React.DOM.span({className:"right"},React.DOM.a(null,this.props.editText))),Button({text:STRINGS.newCallButton,style:"action",onClick:this.onClick}))}}),Footer=React.createClass({displayName:"Footer",render:function(){return React.DOM.div({className:"Footer tip","data-tip":"Sign in to Firefox Account (or other)"},this.props.linkText)}}),HistoryList=React.createClass({displayName:"HistoryList",render:function(){return React.DOM.div({className:"HistoryList"},React.DOM.div({className:"Header"},React.DOM.div(null,STRINGS.callHistory),React.DOM.div({className:"Button"},STRINGS.clearHistory)),React.DOM.ul({className:"CallHistory"},_.range(10).map(function(a){var b,c,d=_.random(0,_users.length-1),e=1===_.random(0,1)?"incoming":"outgoing",f=1===_.random(0,3)?"missed":"accepted";return b=React.DOM.i("missed"===f?{className:"fa fa-times-circle"}:{className:"fa fa-phone"}),c=React.DOM.i("incoming"===e?{"data-tip":"Incoming ("+f+")",className:"fa tip fa-arrow-right"}:{"data-tip":"Outgoing ("+f+")",className:"fa tip fa-arrow-left"}),React.DOM.li({key:"CallerHistory"+a,className:[e,f].join(" ")},c,SmallProfile({user:_users[d]}),React.DOM.div({className:"CallDetails right"},"May 3 4:32pm"))})))}}),Invitation=React.createClass({displayName:"Invitation",render:function(){if(this.props.invite.isActive){var a={width:90*this.props.invite.completed+"%"};return React.DOM.li({className:"Invitation active"},React.DOM.h3(null,this.props.invite.email," ",React.DOM.small(null,"http://lo.op/8dj8d38")),React.DOM.div({className:"expiryInfo"},React.DOM.h5(null,React.DOM.small(null,"3:51pm May 12, 2014")),React.DOM.div(null,React.DOM.div({className:"progressWrapper"},React.DOM.div({className:"progressBar",style:a})),React.DOM.h5({className:"align-right"},React.DOM.i({className:"fa fa-clock-o"})," ",getTimeFromRange(this.props.invite.totalTime)," left."))),React.DOM.div({className:"icons right"},"Revoke Invitation"))}return React.DOM.li({className:"Invitation expired"},React.DOM.h3(null,this.props.invite.email),React.DOM.div({className:"expiryInfo"},React.DOM.h5(null,STRINGS.expired,".")))}}),InvitationList=React.createClass({displayName:"InvitationList",render:function(){var a=_.sortBy(_.range(5).map(function(){var a=_.random(0,_users.length-1),b=1===_.random(0,3)?!1:!0,c=_.random(0,100),d=Math.random();return _.extend(_users[a],{totalTime:c,completed:d,isActive:b})}),function(a){return!a.isActive}),b=function(a,b){return Invitation({key:"Invite"+b,invite:a})}.bind(this);return React.DOM.div({className:"InvitationList"},React.DOM.div({className:"Header"},React.DOM.div(null,STRINGS.invitationList)),React.DOM.ul({className:"Invitations"},a.map(b)))}}),PrecallNotSignedIn=React.createClass({displayName:"PrecallNotSignedIn",render:function(){return BaseState({name:this.props.name,index:this.props.index},TabBar({selected:this.props.tab}),PanelGroup(null,Panel({items:this.props.items},Header({username:STRINGS.loggedOutUsername,editText:STRINGS.changeUsername,slideTo:this.props.slideTo}),Footer({linkText:STRINGS.signIn})),Panel({items:this.props.items},NewCallView(null))))}}),PrecallSignedIn=React.createClass({displayName:"PrecallSignedIn",render:function(){return BaseState({name:this.props.name,index:this.props.index},TabBar({selected:this.props.tab}),PanelGroup(null,Panel({items:this.props.items},Header({username:STRINGS.loggedInUsername,editText:STRINGS.viewAccount}),BuddyList({items:this.props.items}),Footer({linkText:STRINGS.signOut})),Panel({items:this.props.items},NewCallView(null))))}}),CallHistory=React.createClass({displayName:"CallHistory",render:function(){return BaseState({name:this.props.name,index:this.props.index},TabBar({selected:this.props.tab}),Panel({items:this.props.items},HistoryList(null)))}}),InvitationManagement=React.createClass({displayName:"InvitationManagement",render:function(){return BaseState({name:this.props.name,index:this.props.index},TabBar({selected:this.props.tab}),Panel({items:this.props.items},InvitationList(null)))}}),InCallActive=React.createClass({displayName:"InCallActive",render:function(){return BaseStateCorner({name:this.props.name,index:this.props.index},Window({items:this.props.items,title:"Aubrey Drake Graham"},VideoCall(null)))}}),IncomingCallView=React.createClass({displayName:"IncomingCallView",render:function(){return BaseStateCorner({name:this.props.name,index:this.props.index},Window({items:this.props.items,title:"Call from Aubrey Drake Graham",type:""},IncomingCall(null)))}}),ContactsDocked=React.createClass({displayName:"ContactsDocked",render:function(){return BaseStateCorner({name:this.props.name,index:this.props.index},Window({items:this.props.items,title:"Contacts"},BuddyList({items:this.props.items})))}}),states=[{name:"Precall - Not Signed In",view:PrecallNotSignedIn,tab:0,slug:"precall"},{name:"Precall - Signed In",view:PrecallSignedIn,tab:0,slug:"precall-signedin"},{name:"Call History",view:CallHistory,tab:1,slug:"callhistory"},{name:"Invitation Management",view:InvitationManagement,tab:2,slug:"invitationlist"},{name:"Contacts - Docked",view:ContactsDocked,tab:0,slug:"contacts-docked"},{name:"In Call - Active",view:InCallActive,tab:1,slug:"call-active"},{name:"Incoming Call",view:IncomingCallView,tab:1,slug:"call-incoming"}];setTimeout(function(){_.each(states,function(a,b){var c=$("<div/>",{"class":"component-wrapper",id:a.slug})[0];$("#wrapper").append(c);var d=a.view;React.renderComponent(d({items:_users,index:b,tab:a.tab,name:a.name}),c),$(".tip").tipr({mode:"top",speed:200})})},100);